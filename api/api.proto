syntax = "proto3";

package api;

enum Cmd {
  CmdNone = 0;
  CmdHandshake = 1;

  CmdSessionOnConnect = 10;
  CmdSessionOnRecv = 11;
  CmdSessionOnClose = 12;

  CmdSessionSend = 20;
  CmdSessionMultiSend = 21;
  CmdSessionClose = 22;
}

message HandshakeRequest {
  string appID = 1;
  string accessKey = 2;
  string config = 3;
}

message SessionOnConnectNotify {
  string sid = 1;
  string openID = 2;
}

message SessionOnRecvNotify {
  string sid = 1;
  string api = 2;
  map<string, string> headers = 3;
  bytes body = 4;
}

message SessionOnRecvNotifyResponse {
  uint32 status = 1;
  map<string, string> headers = 2;
  bytes body = 3;
}

message SessionOnCloseNotify { string sid = 1; }

message SessionSendRequest {
  string sid = 1;
  bytes data = 2;
}

message SessionMultiSendRequest {
  repeated string sids = 1;
  bytes data = 2;
}
